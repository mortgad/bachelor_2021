---
title: "R Notebook"
output: html_notebook
---

```{r}
# loading packages
pacman::p_load(tidyverse,stringdist, ggplot2, lubridate)

# Color pallette
pal <- wesanderson::wes_palette("Darjeeling1", 16, type = "continuous")
```

```{r}
# Importing data
#csv_files = list.files(pattern="*.csv", path = "data/wordshoal_results/", full.names = T) 
#df = map_df(csv_files, read_csv)
ws_df <- read_csv("./data/wordshoal_results/wordshoal_estimates_2019_2019.csv")
raw_df <- read_csv("./data/folketinget_2009_2021_raw.csv")
```

```{r}
# Mean position and sd of position per month and party
agg <- ws_df %>% group_by(Parti, Month) %>% summarise(mean = mean(theta), sd = sd(theta)) %>% drop_na(sd)

# Mean position of each member grouped by party
ws_df %>% group_by(row_names) %>% summarise(Parti = Parti, mean_theta = mean(theta)) %>% filter(!duplicated(mean_theta)) %>% filter(!row_names %in% c("Thor Pedersen", "Anders Fogh Rasmussen", "SÃ¸ren Gade")) %>% 
  ggplot()+
  aes(x = mean_theta, y = Parti, color = Parti)+
  geom_point()+
  scale_color_manual(values = wesanderson::wes_palette("Darjeeling1", 10, type = "continuous"))+
  labs(title = "Wordshoal - Mean estimated position of each member divided by party", x = "Estimated position", y ="")+
  theme(legend.position = "none")
```


```{r}
# Aggregated pr year
agg %>%   
  mutate(Year = year(Month)) %>% group_by(Year, Parti) %>% summarise(mean = mean(mean)) %>% 
  ggplot()+
  aes(x = Year, y = mean, color = Parti)+
  geom_point()+
  geom_line()+
  scale_color_manual(values = wesanderson::wes_palette("Darjeeling1", 10, type = "continuous"))+
  labs(title = "Wordshoal - Estimated positions for parties per year", y = "Estimated position")
```


# Inspecting SGD classifier results
```{r}
#################### INSPECTING THE RESULTS ###########################
# Import the results
results <- read_csv("../data/cv_results_subset.csv")
```

```{r}
# Plotting the results

results %>% 
  group_by(Year) %>% 
  summarise(kappa = mean(kappa_test)) %>% 
  ggplot()+
  aes(x = Year, y = kappa)+
  geom_point()+
  geom_line(color = wesanderson::wes_palette("Darjeeling1")[2])+
  ylim(0, 1)+
  labs(y = "Kappa score", title = "Level of polarization in Folketinget")
```
```{r}
results %>% group_by(alpha) %>% count()
```

