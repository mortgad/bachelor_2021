View(hep)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Load data
raw_df <- read.csv("./data/folketinget_2009_2021_raw.csv")
library(tidyverse)
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(y="Count", x="Parti", title = "Number of speeches from each party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(y="Count", x="Parti", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(y="Count", x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(y = F , x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none",
axis.title.y = element_blank())
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none",
axis.title.y = element_blank(),
axis.ticks.length.x = 2)
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none",
axis.title.y = element_blank())
theme_set(theme_minimal())
##################################### NO. OF SPEECHES PER PARTY #######################################
raw_df %>%
count(Parti) %>%
ggplot()+
aes(x = reorder(Parti, -n), y = n, fill = Parti, label = n)+
geom_col(width=0.5, position='dodge') +
geom_text(position=position_dodge(0.5), vjust=-.50) +
scale_fill_manual(values = wesanderson::wes_palette(name = "Darjeeling1", n = 16, type = "continuous")) +
labs(x="Party", title = "No. of speeches per party") +
ylim(0, 60000)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none",
axis.title.y = element_blank())
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1"))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of Speeches per year per person")+
theme(legend.title = element_blank(), legend.key = element_rect(color = alpha("black", 0.2)))
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1"))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of Speeches per year per person")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1", n = 4))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of Speeches per year per person")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1", n = 4))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of Speeches Per Year Per Person")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1", n = 4))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of Speeches Per Person")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
############################# LENGTH OF SPEECHES #######################################
# Wrangling
raw_df %>% mutate(text_length = str_length(text)) %>%
group_by(Year) %>%
summarise(mean = mean(text_length),
median = median(text_length),
fifth = quantile(text_length, probs = 0.05),
nintyfifth = quantile(text_length, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1"))+
labs(x = "Year",
y = "Speech length",
title = "Speech length per year")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
############################# LENGTH OF SPEECHES #######################################
# Wrangling
raw_df %>% mutate(text_length = str_length(text)) %>%
group_by(Year) %>%
summarise(mean = mean(text_length),
median = median(text_length),
fifth = quantile(text_length, probs = 0.05),
nintyfifth = quantile(text_length, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1"))+
labs(x = "Year",
y = "Speech length",
title = "Speech length")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
?str_length
############################# LENGTH OF SPEECHES #######################################
# Wrangling
raw_df %>% mutate(text_length = str_length(text)) %>%
group_by(Year) %>%
summarise(mean = mean(text_length),
median = median(text_length),
fifth = quantile(text_length, probs = 0.05),
nintyfifth = quantile(text_length, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1"))+
labs(x = "Year",
y = "Speech length",
title = "Speech length (no. of characters)")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
##################################### NUMBER OF SPEECHES PR. MEMBER PR. YEAR ##########################################
# Wrangling
raw_df %>% group_by(Year, Name, Parti) %>% count() %>%
ungroup() %>% group_by(Year) %>%
summarise(mean = mean(n),
median = median(n),
fifth = quantile(n, probs = 0.05),
nintyfifth = quantile(n, probs = 0.95)
) %>% pivot_longer(!Year) %>%
# Plotting
ggplot()+
aes(x = Year, y = value, color = name, linetype = name)+
geom_line()+
guides(linetype = FALSE)+
scale_color_manual(labels = c("5th %ile", "Mean", "Median", "95th %ile"),
values = wesanderson::wes_palette("Darjeeling1", n = 4))+
labs(x = "Year",
y = "No. of Speeches",
title = "No. of speeches per person")+
theme(legend.title = element_blank(),
legend.key = element_rect(color = alpha("black", 0.2)),
axis.title.y = element_blank())
?rep
rep(1990:2021)
?dnorm
time <- c(rep(1990:2021))
errors <- dnorm(n = 32, mean = 10, sd = 3)
errors <- rnorm(n = 32, mean = 10, sd = 3)
errors <- round(rnorm(n = 32, mean = 10, sd = 3), digits = 0)
